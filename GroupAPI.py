import os
import sys

APIGROUPS=(
'UNIQUE_IDENTIFIER','LOCATION_INFORMATION','NETWORK_INFORMATION','ACCOUNT_INFORMATION','FILE_INFORMATION',
'BLUETOOTH_INFORMATION','DATABASE_INFORMATION','EMAIL','SYNCHRONIZATION_DATA','SMS_MMS','CONTACT_INFORMATION',
'CALENDAR_INFORMATION','SYSTEM_SETTINGS','IMAGE','BROWSER_INFORMATION','NFC','PHONE_CONNECTION','VOIP',
'PHONE_STATE','BLUETOOTH','ACCOUNT_SETTINGS','NETWORK','FILE','LOG','AUDIO','BUNDLE','VIDEO','IPC','WIDGET','WARN_Class'
)


def load_file(filename):
    with open(filename, 'rb') as text_file:
        lines = text_file.readlines()
    return lines


class GroupAPIChecker:


    def loadGroupAPIfile(self):
        self.ApiClassGroup_dict=dict()
        GROUP_API_file = load_file("inf/prmDomains.txt")
        for x in GROUP_API_file:
            x=x.rstrip()
            x=x.strip()
            temp=x.split(b'%')
            apigroup=temp[0].strip().decode("ascii")
            apiclass=temp[1].strip().decode("ascii")
            apifunct=temp[2].strip().decode("ascii")
            if self.ApiClassGroup_dict.get(apiclass)==None:
                self.ApiClassGroup_dict[apiclass]={}
            self.ApiClassGroup_dict[apiclass][apifunct]=apigroup
    def __init__(self):
        self.loadGroupAPIfile()
    def checkAPIGroup(self,classname, functname):
        #ret GROUP name
        if self.ApiClassGroup_dict.get(classname)!=None:
            if self.ApiClassGroup_dict[classname].get(functname)!=None:
                temp= self.ApiClassGroup_dict[classname][functname]
                return temp
            else: 
                if len(list(self.ApiClassGroup_dict[classname].values()))>20:
                    temp = list(self.ApiClassGroup_dict[classname].values())
                    return temp[1]
                if len(list(self.ApiClassGroup_dict[classname].values()))>10:
                    return 'WARN_Class'
                return None
        else:
            return None

#test
#temp=GroupAPIChecker()
#temp2=temp.checkAPIGroup('android.content.Intent',"setComponent")
#print(temp2)