API_CALLS = ("getDeviceId", "getCellLocation", "setFlags", "addFlags", "setDataAndType",
             "putExtra", "init", "query", "insert", "update", "writeBytes", "write",
             "append", "indexOf", "substring", "startService", "getFilesDir",
             "openFileOutput", "getApplicationInfo", "getRunningServices", "getMemoryInfo",
             "restartPackage", "getInstalledPackages", "sendTextMessage", "getSubscriberId",
             "getLine1Number", "getSimSerialNumber", "getNetworkOperator", "loadClass",
             "loadLibrary", "exec", "getNetworkInfo", "getExtraInfo", "getTypeName",
             "isConnected", "getState", "setWifiEnabled", "getWifiState", "setRequestMethod",
             "getInputStream", "getOutputStream", "sendMessage", "obtainMessage", "myPid",
             "killProcess", "readLines", "available", "delete", "exists", "mkdir", "ListFiles",
             "getBytes", "valueOf", "replaceAll", "schedule", "cancel", "read", "close",
             "getNextEntry", "closeEntry", "getInstance", "doFinal", "DESKeySpec",
             "getDocumentElement", "getElementByTagName", "getAttribute",
             "getExternalStorageDirectory","getSimCountryIso","execHttpRequest",
             "getPackageInfo","getSystemService","setWifiDisabled","Cipher","printStackTrace"
)

API_ClASS=(
    "Ljava/net/HttpURLconnection", "Ljava/net/HttpURLconnection", "Lorg/apache/http/client/methods/HttpPost", "Landroid/telephony/SmsMessage",
)
DB_REGEX = '((SELECT|select)\s[\w\*\)\(\,\s]+\s(FROM|from)?\s[\w]+)| ' \
           '((UPDATE|update)\s[\w]+\s(SET|set)\s[\w\,\'\=]+)| ' \
           '((INSERT|insert)\s(INTO|into)\s[\d\w]+[\s\w\d\)\(\,]*\s(VALUES|values)\s\([\d\w\'\,\)]+)| ' \
           '((DELETE|delete)\s(FROM|from)\s[\d\w\'\=]+)'

RESULT_PARAMS = ("APP_Name","folder","permissions","activities","providers","services","libraries","is_obfuscation","is_database",
                "feature_vectors","warn_permissions","warn_strings","API_groups")



PERMISSIONS=(
            'android.permission.BIND_WALLPAPER',
            'android.permission.FORCE_BACK',
            'android.permission.READ_CALENDAR',
            'android.permission.READ_FRAME_BUFFER',
            'android.permission.DEVICE_POWER',
            'android.permission.READ_SYNC_STATS',
            'android.permission.ACCESS_COARSE_UPDATES',
            'android.permission.INTERNET',
            'android.permission.CHANGE_CONFIGURATION',
            'android.permission.CLEAR_APP_USER_DATA',
            'android.permission.HARDWARE_TEST',
            'android.permission.ADD_SYSTEM_SERVICE',
            'android.permission.WRITE_CALL_LOG',
            'android.permission.CHANGE_WIFI_MULTICAST_STATE',
            'android.permission.ACCESS_GPS',
            'android.permission.BIND_INPUT_METHOD',
            'android.permission.CHANGE_WIMAX_STATE',
            'android.permission.WRITE_SYNC_SETTINGS',
            'android.permission.WRITE_USER_DICTIONARY',
            'android.permission.WRITE_GSERVICES',
            'android.permission.INJECT_EVENTS',
            'android.permission.STORAGE',
            'android.permission.WRITE_SECURE_SETTINGS',
            'android.permission.CALL_PRIVILEGED',
            'android.permission.READ_OWNER_DATA',
            'android.permission.SYSTEM_ALERT_WINDOW',
            'android.permission.ACCESS_LOCATION_EXTRA_COMMANDS',
            'android.permission.DUMP',
            'android.permission.MODIFY_PHONE_STATE',
            'android.permission.READ_PROFILE',
            'android.permission.ACCOUNT_MANAGER',
            'android.permission.SET_ANIMATION_SCALE',
            'android.permission.SET_PROCESS_LIMIT',
            'android.permission.SET_DEBUG_APP',
            'android.permission.INSTALL_DRM',
            'android.permission.BLUETOOTH',
            'android.permission.ACCESS_WIFI_STATE',
            'android.permission.SET_WALLPAPER_HINTS',
            'android.permission.CONTROL_LOCATION_UPDATES',
            'android.permission.GLOBAL_SEARCH_CONTROL',
            'android.permission.REBOOT',
            'android.permission.BROADCAST_WAP_PUSH',
            'android.permission.ACCESS_NETWORK_STATE',
            'android.permission.STATUS_BAR',
            'android.permission.CHANGE_WIFI_STATE',
            'android.permission.MOUNT_FORMAT_FILESYSTEMS',
            'android.permission.WRITE_CONTACTS',
            'android.permission.READ_CONTACTS',
            'android.permission.BIND_APPWIDGET',
            'android.permission.ACCESS_LOCATION',
            'android.permission.SIGNAL_PERSISTENT_PROCESSES',
            'android.permission.INSTALL_LOCATION_PROVIDER',
            'android.permission.PERMISSION_NAME',
            'android.permission.ACCESS_DOWNLOAD_MANAGER_ADVANCED',
            'android.permission.WRITE_SETTINGS',
            'android.permission.MASTER_CLEAR',
            'android.permission.READ_INPUT_STATE',
            'android.permission.MANAGE_APP_TOKENS',
            'android.permission.WRITE_SECURE',
            'android.permission.ACCESS_WIMAX_STATE',
            'android.permission.RECORD_AUDIO',
            'android.permission.RECORD_VIDEO',
            'android.permission.WRITE_APN_SETTINGS',
            'android.permission.ACCESS_SURFACE_FLINGER',
            'android.permission.FACTORY_TEST',
            'android.permission.READ_SECURE_SETTINGS',
            'android.permission.READ_LOGS',
            'android.permission.PROCESS_OUTGOING_CALLS',
            'android.permission.UPDATE_DEVICE_STATS',
            'android.permission.SEND_DOWNLOAD_COMPLETED_INTENTS',
            'android.permission.ACCESS_COURSE_LOCATION',
            'android.permission.SET_PREFERRED_APPLICATIONS',
            'android.permission.WRITE_CALENDAR',
            'android.permission.NFC',
            'android.permission.MANAGE_ACCOUNTS',
            'android.permission.SEND_SMS',
            'android.permission.ACCESS_MOCK_LOCATION',
            'android.permission.BIND_ACCESSIBILITY_SERVICE',
            'android.permission.SET_TIME_ZONE',
            'android.permission.WRITE_SMS',
            'android.permission.GET_TASKS',
            'android.permission.DELETE_PACKAGES',
            'android.permission.ACCESS_CHECKIN_PROPERTIES',
            'android.permission.DOWNLOAD_WITHOUT_NOTIFICATION',
            'android.permission.RECEIVE_BOOT_COMPLETED',
            'android.permission.VIBRATE',
            'android.permission.DIAGNOSTIC',
            'android.permission.RECEIVE_SMS',
            'android.permission.CALL_PHONE',
            'android.permission.FLASHLIGHT',
            'android.permission.READ_PHONE_STATE',
            'android.permission.CHANGE_COMPONENT_ENABLED_STATE',
            'android.permission.BRICK',
            'android.permission.ACCESS_SUPERUSER',
            'android.permission.BROADCAST_SMS',
            'android.permission.KILL_BACKGROUND_PROCESSES',
            'android.permission.READ_MEDIA_STORAGE',
            'android.permission.SUBSCRIBED_FEEDS_WRITE',
            'android.permission.CAMERA',
            'android.permission.RECEIVE_MMS',
            'android.permission.WAKE_LOCK',
            'android.permission.ACCESS_DOWNLOAD_MANAGER',
            'android.permission.DELETE_CACHE_FILES',
            'android.permission.READ_PHONE',
            'android.permission.RESTART_PACKAGES',
            'android.permission.GET_ACCOUNTS',
            'android.permission.SUBSCRIBED_FEEDS_READ',
            'android.permission.CHANGE_NETWORK_STATE',
            'android.permission.READ_SYNC_SETTINGS',
            'android.permission.DISABLE_KEYGUARD',
            'android.permission.USE_CREDENTIALS',
            'android.permission.ACCESS_CACHE_FILESYSTEM',
            'android.permission.READ_USER_DICTIONARY',
            'android.permission.WRITE_OWNER_DATA',
            'android.permission.WRITE_MEDIA_STORAGE',
            'android.permission.ACCESS_COARSE_LOCATION',
            'android.permission.BACKUP',
            'android.permission.EXPAND_STATUS_BAR',
            'android.permission.BLUETOOTH_ADMIN',
            'android.permission.ACCESS_FINE_LOCATION',
            'android.permission.PERSISTENT_ACTIVITY',
            'android.permission.SET_ALARM',
            'android.permission.RECEIVE_WAP_PUSH',
            'android.permission.SET_WALLPAPER',
            'android.permission.READ_CALL_LOG',
            'android.permission.BROADCAST_PACKAGE_REMOVED',
            'android.permission.COARSE_FINE_LOCATION',
            'android.permission.SET_ALWAYS_FINISH',
            'android.permission.WRITE_EXTERNAL_STORAGE',
            'android.permission.GET_PACKAGE_SIZE',
            'android.permission.READ_EXTERNAL_STORAGE',
            'android.permission.INSTALL_PACKAGES',
            'android.permission.AUTHENTICATE_ACCOUNTS',
            'android.permission.INTERNAL_SYSTEM_WINDOW',
            'android.permission.CLEAR_APP_CACHE',
            'android.permission.MODIFY_AUDIO_SETTINGS',
            'android.permission.SET_ORIENTATION',
            'android.permission.SET_ACTIVITY_WATCHER',
            'android.permission.READ_SMS',
            'android.permission.BATTERY_STATS',
            'android.permission.GLOBAL_SEARCH',
            'android.permission.REORDER_TASKS',
            'android.permission.ACCESS_DRM',
            'android.permission.BROADCAST_STICKY',
            'android.permission.MOUNT_UNMOUNT_FILESYSTEMS',
            #sign
            'android.permission.ADD_VOICEMAIL',
            'android.permission.USE_SIP',
            'android.permission.BODY_SENSORS',
            'android.permission.CALL_LOG',
            #dangerous

            'android.permission.BIND_AUTOFILL_SERVICE',
            'android.permission.BIND_CARRIER_SERVICES',
            'android.permission.BIND_CHOOSER_TARGET_SERVICE',
            'android.permission.BIND_CONDITION_PROVIDER_SERVICE',
            'android.permission.BIND_DEVICE_ADMIN',
            'android.permission.BIND_DREAM_SERVICE',
            'android.permission.BIND_INCALL_SERVICE',
            'android.permission.BIND_MIDI_DEVICE_SERVICE',
            'android.permission.BIND_NFC_SERVICE',
            'android.permission.BIND_NOTIFICATION_LISTENER_SERVICE',
            'android.permission.BIND_PRINT_SERVICE',
            'android.permission.BIND_SCREENING_SERVICE',
            'android.permission.BIND_TELECOM_CONNECTION_SERVICE',
            'android.permission.BIND_TEXT_SERVICE',
            'android.permission.BIND_TV_INPUT',
            'android.permission.BIND_VISUAL_VOICEMAIL_SERVICE',
            'android.permission.BIND_VOICE_INTERACTION',
            'android.permission.BIND_VPN_SERVICE',
            'android.permission.BIND_VR_LISTENER_SERVICE',
            'android.permission.MANAGE_DOCUMENTS',
            'android.permission.READ_VOICEMAIL',
            'android.permission.REQUEST_INSTALL_PACKAGES',
            'android.permission.WRITE_VOICEMAIL' ,

            'com.google.android.providers.gsf.permission.READ_GSERVICES',
            'org.gnucash.android.permission.RECORD_TRANSACTION',
            'com.motorola.dlauncher.permission.INSTALL_SHORTCUT',
            'thinkpanda.permission.CLEAR_MISSED_CALL',
            'com.estrongs.android.pop.PERMISSION',
            'com.nilhcem.frcndict.permission.C2D_MESSAGE',
            'com.lge.launcher.permission.INSTALL_SHORTCUT',
            'org.linphone.permission.C2D_MESSAGE',
            'com.android.browser.permission.WRITE_HISTORY_BOOKMARKS',
            'com.android.launcher.permission.INSTALL_SHORTCUT',
            'org.openintents.ssh.permission.ACCESS_SSH_AGENT',
            'info.guardianproject.otr.app.providers.imps.permission.READ_ONLY',
            'org.kontalk.permission.C2D_MESSAGE',
            'org.projectmaxs.permission.USE_TRANSPORT',
            'org.mariotaku.twidere.WRITE_DATABASES',
            'com.samsungmobileusa.magnacarta.permission.C2D_MESSAGE',
            'com.sonyericsson.extras.liveview.permission.LIVEVIEW_API',
            'org.mozilla.firefox.permissions.FORMHISTORY_PROVIDER',
            'org.fdroid.k9.permission.REMOTE_CONTROL',
            'com.software.application.permission.C2D_MESSAGE',
            'com.fsck.k9.permission.READ_MESSAGES',
            'org.koxx.k9ForPureWidget.permission.DELETE_MESSAGES',
            'org.mozilla.firefox_sync.permission.PER_ACCOUNT_TYPE',
            'ru.gelin.android.weather.notification.START_UPDATE_SERVICE',
            'org.projectmaxs.permission.WRITE_SMS',
            'com.dririan.RingyDingyDingy.HANDLE_INTERNAL_COMMAND',
            'de.shandschuh.sparserss.READFEEDS',
            'org.eehouse.android.xw4.permission.C2D_MESSAGE',
            'com.google.android.providers.gmail.permission.READ_GMAIL',
            'org.fdroid.k9.permission.DELETE_MESSAGES',
            'com.kaitenmail.permission.DELETE_MESSAGES',
            'org.fdroid.k9.permission.READ_MESSAGES',
            'com.google.android.gm.permission.READ_GMAIL',
            'com.google.android.marvin.feedback.permission.TALKBACK',
            'fr.xgouchet.texteditor.permission.TED_INTERNAL',
            'org.servalproject.meshms.SEND_MESHMS',
            'com.kaitenmail.permission.READ_MESSAGES',
            'com.sec.android.provider.logsprovider.permission.READ_LOGS',
            'org.projectmaxs.permission.USE_FILEREAD',
            'org.koxx.k9ForPureWidget.permission.READ_MESSAGES',
            'com.google.android.gm.permission.READ_CONTENT_PROVIDER',
            'com.android.browser.permission.READ_HISTORY_BOOKMARKS',
            'com.htc.launcher.permission.READ_SETTINGS',
            'com.android.vending.CHECK_LICENSE',
            'org.projectmaxs.permission.USE_MODULE',
            'com.dririan.RingyDingyDingy.HANDLE_COMMAND',
            'org.fdroid.k9.permission.READ_ATTACHMENT',
            'com.umang.dashnotifier.CP_PERMISSION',
            'com.fsck.k9.permission.DELETE_MESSAGES',
            'com.beem.project.beem.BEEM_SERVICE',
            'org.projectmaxs.permission.READ_CONTACTS',
            'com.google.android.apps.iosched.permission.C2D_MESSAGE',
            'com.motorola.launcher.permission.READ_SETTINGS',
            'com.android.email.permission.ACCESS_PROVIDER',
            'com.google.android.marvin.talkback.PERMISSION_SEND_INTENT_BROADCAST_COMMANDS_TO_TALKBACK',
            'com.a209689805250bfb0110b9532a.a93269867a.permission.C2D_MESSAGE',
            'com.android.launcher.permission.WRITE_SETTINGS',
            'org.projectmaxs.permission.USE_MAIN_AS_MODULE',
            'i4nc4mp.myLock.permission.toggle',
            'com.dririan.RingyDingyDingy.EXECUTE_COMMAND',
            'org.dmfs.permission.READ_TASKS',
            'org.mozilla.firefox.permissions.BROWSER_PROVIDER',
            'org.projectmaxs.permission.USE_MAIN',
            'com.android.vending.BILLING',
            'com.android.launcher.permission.READ_SETTINGS',
            'com.google.android.providers.talk.permission.READ_ONLY',
            'com.google.android.apps.dashclock.permission.READ_EXTENSION_DATA',
            'org.dmfs.permission.WRITE_TASKS',
            'org.tint.permissions.services.ADDONS',
            'net.jjc1138.android.scrobbler.privateservices',
            'com.google.android.gtalkservice.permission.GTALK_SERVICE',
            'com.motorola.launcher.permission.INSTALL_SHORTCUT',
            'com.google.android.googleapps.permission.GOOGLE_AUTH.talk',
            'com.androzic.permission.RECEIVE_LOCATION',
            'de.shandschuh.sparserss.WRITEFEEDS',
            'com.androzic.permission.RECEIVE_TRACK',
            'com.google.android.googleapps.permission.GOOGLE_AUTH',
            'com.android.launcher.permission.UNINSTALL_SHORTCUT',
            'com.motorola.dlauncher.permission.READ_SETTINGS',
            'org.projectmaxs.permission.USE_OUTGOING_FILETRANSFER_SERVICE',
            'org.gnucash.android.permission.CREATE_ACCOUNT',
            'com.mominis.permission.preferences.provider.READ_WRITE',
            'com.android.email.permission.READ_ATTACHMENT',
            'com.androzic.permission.NAVIGATION',
            'com.lge.launcher.permission.READ_SETTINGS',
            'org.servalproject.rhizome.RECEIVE_FILE',
            'at.tomtasche.reader.DOCUMENT_CHANGED',
            'com.google.android.c2dm.permission.RECEIVE',
            'archos.permission.FULLSCREEN.FULL',
            'org.projectmaxs.permission.USE_FILEWRITE',
            'org.projectmaxs.permission.USE_MAIN_AS_TRANSPORT',
            'org.projectmaxs.permission.USE_INCOMING_FILETRANSFER_SERVICE',
            'com.google.android.apps.googlevoice.permission.RECEIVE_SMS',
            'org.mariotaku.twidere.READ_DATABASES',
            'info.guardianproject.otr.app.providers.imps.permission.WRITE_ONLY',
            'com.android.alarm.permission.SET_ALARM',
            'com.cyanogenmod.filemanager.permissions.READ_THEME',
            'org.mozilla.firefox.permissions.PASSWORD_PROVIDER',
            'org.thialfihar.android.apg.permission.READ_KEY_DETAILS',
            'com.fede.launcher.permission.READ_SETTINGS',
            'org.adw.launcher.permission.READ_SETTINGS',
            'org.mariotaku.twidere.ACCESS_SERVICE',
            'org.adw.launcher.permission.WRITE_SETTINGS',
            'org.mozilla.firefox.permission.PER_ANDROID_PACKAGE',
            'info.guardianproject.otr.app.im.permission.IM_SERVICE',
            'com.fsck.k9.permission.READ_ATTACHMENT',
            'com.sec.android.provider.logsprovider.permission.WRITE_LOGS',
            'com.fsck.k9.permission.REMOTE_CONTROL')           